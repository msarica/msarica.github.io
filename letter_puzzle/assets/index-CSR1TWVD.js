(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const r of e)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function n(e){const r={};return e.integrity&&(r.integrity=e.integrity),e.referrerPolicy&&(r.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?r.credentials="include":e.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(e){if(e.ep)return;e.ep=!0;const r=n(e);fetch(e.href,r)}})();function c(){const l=document.getElementById("app");if(!l)return;const t=document.createElement("button");t.id="print-btn",t.innerHTML="🖨️ Print Puzzle",t.type="button",t.setAttribute("aria-label","Print this puzzle"),t.style.marginBottom="1.5em",t.disabled=!0,t.classList.add("disabled"),t.addEventListener("click",()=>{t.disabled||window.print()}),l.appendChild(t)}window.addEventListener("DOMContentLoaded",c);const a=document.getElementById("puzzle-input"),u=document.getElementById("generate-btn"),d=document.getElementById("cipher-output"),o=document.getElementById("letter-map");function p(l){const t=Array.from(new Set(l.toUpperCase().replace(/[^A-Z]/g,""))),n=Array.from({length:26},(r,s)=>s+1);for(let r=n.length-1;r>0;r--){const s=Math.floor(Math.random()*(r+1));[n[r],n[s]]=[n[s],n[r]]}const i={};let e=0;for(const r of t)i[r]=n[e++];return i}function m(l,t){return l.trim().toUpperCase().split(/\s+/).map(n=>`<div class='printable-word'>${n.split("").map(e=>t[e]?`<div class='print-cell'>
          <div class='print-num'>${t[e]}</div>
          <div class='print-box'></div>
        </div>`:/[^A-Z]/.test(e)?`<div class='print-cell'>
          <div class='print-num'>&nbsp</div>
          <div class='print-punct'>${e}</div>
        </div>`:`<div class='print-cell'>
          <div class='print-num'>?</div>
          <div class='print-box'></div>
        </div>`).join("")}</div>`).join('<div class="print-space"></div>')}function f(l,t){const n=Object.keys(l).reduce((e,r)=>{const s=l[r];return t.includes(r)&&(e[s]=r),e},{});let i='<div class="letter-map-grid">';for(let e=0;e<26;e++){const r=e+1,s=n[r]??"";i+=`<div class="letter-cell">
      <span class="letter">${r}</span>
      <div class='print-box'>${s}</div>
    </div>`}return i+="</div>",i}function v(l,t){const n=t.toUpperCase().replace(/[^A-Z]/g,"").split("");if(n.length===0)return"";let i='<div class="cipher-key-table-horizontal"><table><tr>';return n.forEach(e=>{i+=`<th>${e}</th>`}),i+="</tr><tr>",n.forEach(e=>{i+=`<td>${l[e]||""}</td>`}),i+="</tr></table></div>",i}function h(l){const t=Object.keys(l).sort();if(t.length===0)return"";let n='<div class="full-cipher-map-table"><table><tr>';return t.forEach(i=>{n+=`<th>${i}</th>`}),n+="</tr><tr>",t.forEach(i=>{n+=`<td>${l[i]}</td>`}),n+="</tr></table></div>",n}document.getElementById("toggle-cipher-map").addEventListener("change",function(){const l=document.getElementById("full-cipher-map-table");l.style.display=this.checked?"":"none"});u.addEventListener("click",()=>{const l=a.value,t=document.getElementById("hint-input").value,n=document.getElementById("print-btn");if(!l.trim()){d.innerHTML="<em>Please enter some text.</em>",document.getElementById("cipher-key-table").innerHTML="",document.getElementById("full-cipher-map-table").innerHTML="",o.innerHTML="",n&&(n.disabled=!0,n.classList.add("disabled"));return}const i=p(l);d.innerHTML=`<div class='puzzle-title'>Secret Text</div><div class='printable-puzzle'>${m(l,i)}</div>`,document.getElementById("cipher-key-table").innerHTML=v(i,t),document.getElementById("full-cipher-map-table").innerHTML=h(i),document.getElementById("full-cipher-map-table").style.display=document.getElementById("toggle-cipher-map").checked?"":"none",o.innerHTML=f(i,t.toUpperCase().replace(/[^A-Z]/g,"").split("")),n&&(n.disabled=!1,n.classList.remove("disabled"))});
