(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const s of n.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&i(s)}).observe(document,{childList:!0,subtree:!0});function r(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerPolicy&&(n.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?n.credentials="include":e.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(e){if(e.ep)return;e.ep=!0;const n=r(e);fetch(e.href,n)}})();function c(){const l=document.getElementById("app");if(!l)return;const t=document.createElement("button");t.id="print-btn",t.innerHTML="ðŸ–¨ï¸ Print Puzzle",t.type="button",t.setAttribute("aria-label","Print this puzzle"),t.style.marginBottom="1.5em",t.disabled=!0,t.classList.add("disabled"),t.addEventListener("click",()=>{t.disabled||window.print()}),l.appendChild(t)}window.addEventListener("DOMContentLoaded",c);const p=document.getElementById("puzzle-input"),u=document.getElementById("generate-btn"),d=document.getElementById("cipher-output"),o=document.getElementById("letter-map");function m(l){const t=Array.from(new Set(l.toUpperCase().replace(/[^A-Z]/g,""))),r=Array.from({length:26},(n,s)=>s+1);for(let n=r.length-1;n>0;n--){const s=Math.floor(Math.random()*(n+1));[r[n],r[s]]=[r[s],r[n]]}const i={};let e=0;for(const n of t)i[n]=r[e++];return i}function f(l,t,r=[]){const i=new Set(r.map(e=>e.toUpperCase()));return l.trim().toUpperCase().split(/\s+/).map(e=>`<div class='printable-word'>${e.split("").map(s=>{if(t[s]){const a=i.has(s)?s:"";return`<div class='print-cell'>
          <div class='print-num'>${t[s]}</div>
          <div class='print-box'>${a}</div>
        </div>`}else return/[^A-Z]/.test(s)?`<div class='print-cell'>
          <div class='print-num'>&nbsp</div>
          <div class='print-punct'>${s}</div>
        </div>`:`<div class='print-cell'>
          <div class='print-num'>?</div>
          <div class='print-box'></div>
        </div>`}).join("")}</div>`).join('<div class="print-space"></div>')}function v(l,t){const r=Object.keys(l).reduce((e,n)=>{const s=l[n];return t.includes(n)&&(e[s]=n),e},{});let i='<div class="letter-map-grid">';for(let e=0;e<26;e++){const n=e+1,s=r[n]??"";i+=`<div class="letter-cell">
      <span class="letter">${n}</span>
      <div class='print-box'>${s}</div>
    </div>`}return i+="</div>",i}function b(l,t){const r=t.toUpperCase().replace(/[^A-Z]/g,"").split("");if(r.length===0)return"";let i='<div class="cipher-key-table-horizontal"><table><tr>';return r.forEach(e=>{i+=`<th>${e}</th>`}),i+="</tr><tr>",r.forEach(e=>{i+=`<td>${l[e]||""}</td>`}),i+="</tr></table></div>",i}function h(l){const t=Object.keys(l).sort();if(t.length===0)return"";let r='<div class="full-cipher-map-table"><table><tr>';return t.forEach(i=>{r+=`<th>${i}</th>`}),r+="</tr><tr>",t.forEach(i=>{r+=`<td>${l[i]}</td>`}),r+="</tr></table></div>",r}document.getElementById("toggle-cipher-map").addEventListener("change",function(){const l=document.getElementById("full-cipher-map-table");l.style.display=this.checked?"":"none"});u.addEventListener("click",()=>{const l=p.value,t=document.getElementById("hint-input").value,r=document.getElementById("print-btn");if(!l.trim()){d.innerHTML="<em>Please enter some text.</em>",document.getElementById("cipher-key-table").innerHTML="",document.getElementById("full-cipher-map-table").innerHTML="",o.innerHTML="",r&&(r.disabled=!0,r.classList.add("disabled"));return}const i=m(l),e=t.toUpperCase().replace(/[^A-Z]/g,"").split(""),n=`
    <div class="printable-instructions" style="background:#fffbe6;border:2px solid #6a5acd;border-radius:10px;padding:1em 1.5em;margin:0 auto 1.5em auto;max-width:600px;font-size:0.7em;color:#333;text-align:left;">
      <b>How to Solve:</b>
      <ul style="margin:0.5em 0 0 1.2em;padding:0;">
        <li>Each letter is a number. Write the matching letter in each box.</li>
        <li>Use the map at the bottom to help you solve!</li>
        <li>Have fun!</li>
      </ul>
    </div>
  `;d.innerHTML=`${n}<div class='puzzle-title'>Secret Text</div><div class='printable-puzzle'>${f(l,i,e)}</div>`,document.getElementById("cipher-key-table").innerHTML=b(i,t),document.getElementById("full-cipher-map-table").innerHTML=h(i),document.getElementById("full-cipher-map-table").style.display=document.getElementById("toggle-cipher-map").checked?"":"none",o.innerHTML=v(i,e),r&&(r.disabled=!1,r.classList.remove("disabled"))});
